<!-- CONTENTS-------------------------------------------------------------------------------------------------->
<div class="contents">
<!-- Section1 about---------------------------------------------------> 
<style>
	dl.tours{
		padding-left: 2em;
	}
	dl.tours dt {
		display:inline-block;
		vertical-align:top;
	}
	dl.tours dd {
		display:inline-block;
	}
	td.time {
		word-break:keep-all;
	}
	table.border2 td.avail {
		text-align:center;
		vertical-align:middle;
	}
	.btn,
	a.btn,
	button.btn {
	font-size: 1.3rem;
	font-weight: 700;
	line-height: 0.9;
	position: relative;
	display: inline-block;
	padding: 1rem 4rem;
	cursor: pointer;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
	-webkit-transition: all 0.3s;
	transition: all 0.3s;
	text-align: center;
	vertical-align: middle;
	text-decoration: none;
	letter-spacing: 0.1em;
	color: #212529;
	border-radius: 0.5rem;
	}
	.btn--orange,
	a.btn--orange {
	color: #fff;
	background-color: #eb6100;
	}

	.btn--orange:hover,
	a.btn--orange:hover {
	color: #fff;
	background: #f56500;
	}

	.btn--bule,
	a.btn--bule {
	color: #fff;
	background-color: #0027eb;
	}
	.btn--bule:hover,
	a.btn--bule:hover {
	color: #fff;
	background: #3b00eb;
	}

	.btn--red,
	a.btn--red {
	color: #fff;
	background-color: #e32424;
	}

	.btn--red:hover,
	a.btn--red:hover {
	color: #fff;
	background: #e90e0e;
	}

	/* カレンダー */
	input[type="date"]{
	position: relative;
	}

	input[type=date]::-webkit-calendar-picker-indicator {
	position: absolute;
	width: 100%;
	height: 100%;
	opacity: 0;
	}
</style>
<section id="about">
<div id="main">
<!-- システムメッセージ -->
<div id="systemMsg"></div>
<form action="<?php echo base_url();?>CarRental_con/save" method="post" autocomplete="off" id="car_rental" >
	<h2 style ="background:#005084">EPC2025　レンタカー申込</h2>
	<input type="hidden" name="<?= $this->security->get_csrf_token_name();?>" value="<?= $this->security->get_csrf_hash();?>"/>
	<input type="hidden" name="reserve[R01_User_Id]" value="<?= !empty($reserve['R01_User_Id'])?h($reserve['R01_User_Id']):''?>"/>
	<?php if(!empty($this->session->tempdata('success_flash'))):?>
		<div class="alert alert-success" role="alert">
			<strong><?= $this->session->tempdata('success_flash');?></strong>
		</div>
	<?php endif;?>
	
	<img src="<?php echo base_url();?>img/car_plan.png" alt="" style="margin-top: 20px; margin-bottom: 30px; max-width: 100%; height: auto;"/>

	<table class="border2" width="100%" style="table-layout:fixed">
		<tr>
			<th class="required" style="width:30%">予約クラス</th>
			<td>
				<?php if(!empty($rental_stocks)):?>
					<?php foreach($rental_stocks as $stocks):?>
						<label class="form-radio form-icon form-text coupon-label mar-rgt">
							<input 
								type="radio" 
								name="reserve[R01_Class]" 
								value="<?= !empty($stocks['R02_Class'])?h($stocks['R02_Class']):''?>" 
								<?= !empty($stocks['R02_Class']) && !empty($reserve['R01_Class']) && $stocks['R02_Class'] == $reserve['R01_Class'] ?'checked':'';?>
							><?= !empty($stocks['R02_Class'])?h($stocks['R02_Class']).'クラス':'';?>　
						</label>
					<?php endforeach;?>
				<?php endif;?>
				<small><?= form_error('reserve[R01_Class]'); ?></small>
			</td>
		</tr>
		<tr>
			<th class="required" style="width:30%">貸出日時</th>
			<td>
				<input type="hidden" name="reserve[R01_FromDriveDate]" value=""/>
				日付 <select name="reserve[R01_FromDriveDate]" required>
				<option value="">選択してください</option>
					<option value="2024-03-31" <?=!empty($reserve['R01_FromDriveDate']) && $reserve['R01_FromDriveDate'] == "2024-03-31" ? 'selected':''?>>2025年3月31日</option>
					<option value="2024-04-01" <?=!empty($reserve['R01_FromDriveDate']) && $reserve['R01_FromDriveDate'] == "2024-04-01" ? 'selected':''?>>2025年4月 1日</option>
					<option value="2024-04-02" <?=!empty($reserve['R01_FromDriveDate']) && $reserve['R01_FromDriveDate'] == "2024-04-02" ? 'selected':''?>>2025年4月 2日</option>
				</select>

				<input type="hidden" name="reserve[R01_FromDriveTime]" value=""/>
				時間 <select name="reserve[R01_FromDriveTime]" required>
					<option value="">--:--</option>
					<option value="08:30" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "08:30" ? 'selected':''?>>08:30</option>
					<option value="09:00" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "09:00" ? 'selected':''?>>09:00</option>
					<option value="09:30" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "09:30" ? 'selected':''?>>09:30</option>
					<option value="10:00" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "10:00" ? 'selected':''?>>10:00</option>
					<option value="10:30" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "10:30" ? 'selected':''?>>10:30</option>
					<option value="11:00" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "11:00" ? 'selected':''?>>11:00</option>
					<option value="11:30" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "11:30" ? 'selected':''?>>11:30</option>
					<option value="12:00" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "12:00" ? 'selected':''?>>12:00</option>
					<option value="12:30" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "12:30" ? 'selected':''?>>12:30</option>
					<option value="13:00" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "13:00" ? 'selected':''?>>13:00</option>
					<option value="13:30" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "13:30" ? 'selected':''?>>13:30</option>
					<option value="14:00" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "14:00" ? 'selected':''?>>14:00</option>
					<option value="14:30" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "14:30" ? 'selected':''?>>14:30</option>
					<option value="15:00" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "15:00" ? 'selected':''?>>15:00</option>
					<option value="15:30" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "15:30" ? 'selected':''?>>15:30</option>
					<option value="16:00" <?=!empty($reserve['R01_FromDriveTime']) && $reserve['R01_FromDriveTime'] == "16:00" ? 'selected':''?>>16:00</option>
				</select>
				<small><?= form_error('reserve[R01_FromDriveDate]'); ?></small>
				<small><?= form_error('reserve[R01_FromDriveTime]'); ?></small>
			</td>
		</tr>
		<tr>
			<th class="required" style="width:30%">返却日時</th>
			<td>
				<input type="hidden" name="reserve[R01_ToDriveDate]" value=""/>
				日付 <select name="reserve[R01_ToDriveDate]" required onchange="setHenkyaku();">
				<option value="">選択してください</option>
					<option value="2024-03-31" <?=!empty($reserve['R01_ToDriveDate']) && $reserve['R01_ToDriveDate'] == "2024-03-31" ? 'selected':''?>>2025年3月31日</option>
					<option value="2024-04-01" <?=!empty($reserve['R01_ToDriveDate']) && $reserve['R01_ToDriveDate'] == "2024-04-01" ? 'selected':''?>>2025年4月 1日</option>
					<option value="2024-04-02" <?=!empty($reserve['R01_ToDriveDate']) && $reserve['R01_ToDriveDate'] == "2024-04-02" ? 'selected':''?>>2025年4月 2日</option>
				</select>

				<input type="hidden" name="reserve[R01_ToDriveTime]" value=""/>
				時間 <select name="reserve[R01_ToDriveTime]" required id="returntime">
					<option value="">--:--</option>
					<option value="08:30" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "08:30" ? 'selected':''?>>08:30</option>
					<option value="09:00" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "09:00" ? 'selected':''?>>09:00</option>
					<option value="09:30" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "09:30" ? 'selected':''?>>09:30</option>
					<option value="10:00" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "10:00" ? 'selected':''?>>10:00</option>
					<option value="10:30" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "10:30" ? 'selected':''?>>10:30</option>
					<option value="11:00" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "11:00" ? 'selected':''?>>11:00</option>
					<option value="11:30" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "11:30" ? 'selected':''?>>11:30</option>
					<option value="12:00" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "12:00" ? 'selected':''?>>12:00</option>
					<option value="12:30" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "12:30" ? 'selected':''?>>12:30</option>
					<option value="13:00" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "13:00" ? 'selected':''?>>13:00</option>
					<option value="13:30" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "13:30" ? 'selected':''?>>13:30</option>
					<option value="14:00" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "14:00" ? 'selected':''?>>14:00</option>
					<option value="14:30" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "14:30" ? 'selected':''?>>14:30</option>
					<option value="15:00" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "15:00" ? 'selected':''?>>15:00</option>
					<option value="15:30" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "15:30" ? 'selected':''?>>15:30</option>
					<option value="16:00" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "16:00" ? 'selected':''?>>16:00</option>
					<option value="16:30" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "16:30" ? 'selected':''?>>16:30</option>
					<option value="17:00" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "17:00" ? 'selected':''?>>17:00</option>
					<option value="17:30" <?=!empty($reserve['R01_ToDriveTime']) && $reserve['R01_ToDriveTime'] == "17:30" ? 'selected':''?>>17:30</option>
				</select>
				<small><?= form_error('reserve[R01_ToDriveDate]'); ?></small>
				<small><?= form_error('reserve[R01_ToDriveTime]'); ?></small>
			</td>
		</tr>
		<tr>
			<th class="required" style="width:30%">チャイルドシート</th>
			<td>
				<input type="hidden" name="reserve[R01_Child_Seat]" value=""/>
				<select name="reserve[R01_Child_Seat]">
					<?php if(!empty($this->child_seat)):?>
						<option value="0">不要</option>
						<?php foreach($this->child_seat as $index => $seat):?>
							<option 
								value="<?=$index?>"
								<?= !empty($reserve['R01_Child_Seat']) && $index == $reserve['R01_Child_Seat'] ? 'selected':''?>
							><?= $seat?></option>
						<?php endforeach;?>
					<?php endif;?>
				</select>
				<small><?= form_error('reserve[R01_Child_Seat]'); ?></small>
			</td>
		</tr>
		<tr>
			<th class="required" style="width:30%">レンタカー安心パック（RAP）</th>
			<td>
				<input type="hidden" name="reserve[R01_Car_Insurance]" value=""/>
				<select name="reserve[R01_Car_Insurance]" required>
					<option value="加入する" <?=!empty($reserve['R01_Car_Insurance']) && $reserve['R01_Car_Insurance'] == "加入する" ? 'selected':''?>>加入する</option>
					<option value="加入しない" <?=!empty($reserve['R01_Car_Insurance']) && $reserve['R01_Car_Insurance'] == "加入しない" ? 'selected':''?>>加入しない</option>
				</select>
			</td>
		</tr>
		<tr>
			<th class="required" style="width:30%">運転者氏名（漢字）</th>
			<td>
				<input type="text" name="reserve[R01_Name_Kanji]" value="<?=!empty($reserve['R01_Name_Kanji'])?h($reserve['R01_Name_Kanji']):''?>" required/>
				<small><?= form_error('reserve[R01_Name_Kanji]'); ?></small>
			</td>
		</tr>
		<tr>
			<th class="required" style="width:30%">運転者氏名（カナ）</th>
			<td>
				<input type="text" name="reserve[R01_Name_Kana]" value="<?=!empty($reserve['R01_Name_Kana'])?h($reserve['R01_Name_Kana']):''?>" required/>
				<small><?= form_error('reserve[R01_Name_Kana]'); ?></small>
			</td>
		</tr>
		<tr>
			<th class="required" style="width:30%">免許証番号</th>
			<td>
				<input type="text" name="reserve[R01_Driver_License_No]" value="<?=!empty($reserve['R01_Driver_License_No'])?h($reserve['R01_Driver_License_No']):''?>" required/>
				<small><?= form_error('reserve[R01_Driver_License_No]'); ?></small>
			</td>
		</tr>
		<tr>
			<th class="required" style="width:30%">免許証有効期限</th>
			<td>
				<input type="date" name="reserve[R01_Driver_License_Expiry]" value="<?=!empty($reserve['R01_Driver_License_Expiry'])?h($reserve['R01_Driver_License_Expiry']):''?>" required/>
				<small><?= form_error('reserve[R01_Driver_License_Expiry]'); ?></small>
			</td>
		</tr>
	</table>

<div style="text-align: center;margin-top:1em;">
	<div class="his-button" style="border-radius: 5px;">
		<a onclick="go_conf_back();" class="btn btn--bule">戻る</a>
		&nbsp;&nbsp;&nbsp;
		<input type="submit" class="btn btn--orange" style="border:none" value="登録">
	</div>
</div>
</form>

<?php if(!empty($reserve) && !empty($reserve['R01_Regist_Flg'])):?>
<form action="<?php echo base_url();?>CarRental_con/cancel" method="post" autocomplete="off" onSubmit="return check()" >
<input type="hidden" name="<?= $this->security->get_csrf_token_name();?>" value="<?= $this->security->get_csrf_hash();?>"/>
	<div style="text-align: center;margin-top:1em;">
		<div class="his-button" style="border-radius: 5px;">
			<input type="submit" class="btn btn--red" style="border:none" value="キャンセル">
		</div>
	</div>
</form>
<?php endif;?>

<img src="<?php echo base_url();?>img/car_Insurance.png" alt="" style="margin-top: 20px; margin-bottom: 30px; max-width: 100%; height: auto;"/>

<p style="text-align: center; margin-top: 50px; font-size: 20px;">クラス在庫状況<p>
<div align="center" > 
	<table class="border2" width="100%" style="width: 500px; margin: 0 auto;">
		<tr>
			<th></th>
			<th>SA</th>
			<th>RA</th>
			<th>EA</th>
			<th>WA</th>
		</tr>

		<?php foreach($rental_stocks_table as $stock):?>
			<tr>
				<td style="text-align: center;">
					<?php	if($stock['day']<31){$ym="2025年4月";}else{$ym="2025年3月";} ?>
					<?=$ym.$stock['day'] ?>日
				</td>
				<td style="text-align: center;">
					<?=$stock['SA'] ?>
				</td>
				<td style="text-align: center;">
					<?=$stock['RA'] ?>
				</td>
				<td style="text-align: center;">
					<?=$stock['EA']?>
				</td>
				<td style="text-align: center;">
					<?=$stock['WA']?>
				</td>
			</tr>
		<?php endforeach;?>
	</table>
</div>

</div>
</section>
<script>
function setHenkyaku()
{
	if(getElementByName('reserve[R01_ToDriveDate]')=="2024-04-02"){
		var select = document.getElementById('returntime');
		// option要素を削除（方法はいろいろありますが）
		while (0 < select.childNodes.length) {
			select.removeChild(select.childNodes[0]);
		}
		var option = "";
		var text = "";
		var timearray = ('08:30','09:00','09:30','10:00','10:30','11:00','08:30','08:30','08:30','08:30','08:30','08:30','08:30','08:30',);
		// option要素を生成
		option = document.createElement('option');
		text = document.createTextNode('08:30');
		option.value="08:30"; 
		option.appendChild(text);
		select.appendChild(option);
	}ekse{
	}
	// option要素を追加
	select.appendChild(option);

	// 必要な分だけoption生成と追加を繰り返す
}</script>